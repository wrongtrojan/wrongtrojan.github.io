+++
title = "11.流类库与输入输出"
weight=14
date = 2025-12-06
draft = false
tags=["Cpp","流类","字符串"]
+++
<!--more-->

## I/O流的概念及流类库结构

>       流是一种抽象，在数据生产者和数据消费者间建立联系，并管理数据流动
>
>       文件对象有点特性，流对象也有，程序将流对象看作是文件对象的化身
>
>       一般意义的读操作在流数据抽象中被称为提取，写操作被称为插入


## 输出流

>       输出流对象是信息流动的目标，最重要三个是ostream，ofstream，ostringstream

>### ostream
>
>       cout是标准输出流
>
>       cerr是标准错误输出流，没有缓冲，发送给它的内容立即被输出
>
>       clog类似与cerr，但有缓冲，缓冲区满时被输出
>
>       *标准输入流和输出流的区别在输出重定向时
>
>           用命令行符>"filename",cout输出内容会写到文件中，屏幕看不到
>
>           cerr不受>影响，依旧直接显示在屏幕上，不写到文件里
>
>           cerr可以通过2>"filename"进行重定向输出

>### ofstream
>
>       ofstream类支持磁盘文件输出，需要只输出的磁盘文件可构造ofstream类对象
>
>       打开文件之前或之后可以指定ofstream对象接受二进制或文本模式数据
>
>       很多格式化选项和成员函数可用于ofstream对象，ios和ostream所有功能
>
>       在构造函数中指定文件名，构造文件时文件自动打开
>
>       或用open函数打开文件，或在文件标识符标识的打开文件上构造ofstream对象

>### 构造输出对象
>
>       如果使用预定义的cout、cerr、clog对象不需要构造输出流
>
>       如果使用文件流将信息输出到文件，需要使用构造函数来建立流对象
>
>           使用默认构造函数后调用open成员函数
>
>               ofstream myFile;
>
>               myFile.open("filename");
>
>           在调用构造函数时指定文件名
>
>               ofstream myFile("filename");
>
>           可以使用同一个流先后打开不同的文件(同一个时刻只有一个打开)

>### 使用插入运算符和操纵符
>
>       插入运算符"<<"是所有标准Cpp数据类型预先设计的
>
>       插入运算符与预先定义的操纵符(manipulator)一起工作，用于控制输出格式
>
>       很多操作符都定义在ios_base类中和iomanip头文件中
>
>       输出宽度
>
>           在流中放入setw操作符或调用width成员函数指定输出宽度
>
>           默认填充符是空格，使用fill成员函数可以设置填充字符的值cout.fill()
>
>           setw和width都不截断数值，数值超指定宽度时显示全部值
>
>           setw和width仅影响紧随其后的域，一个域输出完后宽度恢复默认
>
>       对齐方式
>
>           输出流默认为右对齐文本
>
>           通过使用带参数的setiosflags(定义在iomanip中)操纵符来设置对齐方式
>
>           setiosflags的影响是持久的，直到用resetiosflags重新恢复默认值为止
>
>           seriosflags的参数是流的格式标识值，由下位掩码指定，可用\|运算符组合
>
>               ios_base::skipws 在输入中跳过空白
>
>               ios_base::left 左对齐值，用填充字符填充右边
>
>               ios_base::right 右对齐值，用填充字符填充左边
>
>               ios_base::internal 规定宽度内，指定前缀符号后数值前插入指定填充字符
>
>               ios_base::unitbuf 在每次插入之后转储并清除缓冲区内容
>
>       精度
>
>           ios_base::showpoint 对浮点数值显示小数点和尾部的0
>
>           ios_base::showpos 对非负数显示正号
>
>           ios_base::scientific 以科学格式显示浮点数值
>
>           ios_base::fixed 以顶点格式显示浮点数值(没有指数部分)
>
>           可以使用setprecision操作符，以及ios_base::fixed和ios_base::scientific
>
>           如果不指定fixed或scientific精度值表示有效数字位数
>
>           如果设置了ios_base::fixed和ios_base::scientific，精度值表示小数点后位数
>
>       进制
>
>           ios_base::showbase 插入前缀符号以表明整数的数制
>
>           ios_base::uppercase 对十六进制数值显示A-F，对于科学格式显示E
>
>           ios_base::dec 以是静止形式格式化数值
>
>           ios_base::oct 以八进制形式格式化数值
>
>           ios_base::hex 以十六进形式格式化数值
>
>           dec、oct和hex操作符设置输入和输出的缺省进制

>### 文件输出流成员函数
>
>       输出流函数类型
>
>           与操作符等价的成员函数
>
>           执行非格式化写操作的成员函数
>
>           其他修改流状态且不同于操纵符或插入运算符的成员函数
>
>           *对于顺序的格式化输出，可以仅使用插入运算符和操纵符
>
>           *对于随机访问二进制磁盘输出，用其他成员函数可选择性使用插入运算符
>
>       输出流的open函数
>
>           使用文件输出流，须在构造函数或open函数把流与特定磁盘文件关联
>
>           打开一个与输出流关联的文件时，可以指定一个open_mode标志
>
>           ios_base::app 打开输出文件在文件尾添加数据
>
>           ios_base::ate 打开一个现存文件并查找到结尾
>
>           ios_base::in 打开输入文件，只读不写
>
>           ios_base::out 打开文件输出，此模式对ofstream对象隐含指定
>
>           ios_base::trunc 打开文件删除原有内容，若无非out指定则为隐含指定
>
>           ios_base::binary 以二进制模型打开一个文件(默认是文本模式)
>
>       输出流的close函数
>
>           close成员函数关闭与一个文件输出流关联的磁盘文件
>
>           文件使用完毕后必须将其关闭以完成所有磁盘输出
>
>           如果需要在同一流对象上打开另外的文件，就需要使用close函数
>
>           如果输出流对象析构前为调用close函数关闭，输出流析构函数自动关闭
>
>       put函数
>
>           put函数把一个字符写到输出流中，不受流的格式化参量的影响
>
>       write函数
>
>           write函数把内存的一块内容写到一个文件输出流中，长度参数指出字节数
>
>           write函数遇到空字符时并不停止，能够写入完整的类结构
>
>           函数带两个参数：char指针(需reinterpret_cast显式转换)，一个字节数
>
>       seekp和tellp函数
>
>           一个文件输出流保存一个内部指针指出下一次写数据的位置
>
>           seekp成员函数设置这个指针，因此可以以随机方式相磁盘文件输出
>
>           tellp成员函数返回该文件位置指针值
>
>       错误处理函数
>
>           bad 出现不可恢复的错误，返回一个非0值
>
>           fail 出现不可恢复错误或预期条件返回非0值，零参调用clear清除错误标记
>
>           good 如果所有错误标记和文件结束标记都是清除的，返回一个非零值
>
>           eof 遇到文件结尾条件，则返回一个非0值
>
>           clear 设置内部错误状态，如果用默认参数调用，则清除所有错误位
>
>           rdstate 返回当前错误状态
>
>           ！运算符经过重载与fail函数执行相同的功能
>
>           void*( )也经过重载，与！运算符相反
>
>           void*( )不等价于good，因为不检测文件结尾

>### 二进制输出文件
>
>       不同操作系统的文本文件的行分隔符不尽相同
>
>       Windows操作系统下的文本文件以一个换行符和回车符作为行分隔
>
>       则以文本模式输出时，Windows系统下输出换行符会被自动扩充一个回车符
>
>       若出现问题则需采用二进制模式输出，所写字符不转换
>
>       二进制模式输出到文件，需在打开模式中设置ios_base::binary

>### 字符串输出流
>
>       输出流除了可以用于向屏幕或文件输出信息外，还可以用于生成字符串
>
>       这样的流叫字符串流，ostringstream类就表示一个字符串输出流
>
>       ostringstream类有俩个构造函数
>
>           第一个构造函数有一个形参，表示流的打开模式
>
>           第二个构造函数接收两个形参，第一个给流赋初值，第二个表示打开模式
>
>       ostringstream类的功能
>
>           ostring与of(stream)同为ostream派生类，ostring具有of(stream)大部分功能
>
>           专用于文件操作的open函数和close函数是ostringstream类不具备的
>
>           ostringstream类还有特有的函数str，返回string对象表示输出流生成的内容
>
>           to_string函数模板可以把各种支持"\<\<"插入符的类型的对象转换为字符串

## 输入流

>       输入流对象是数据流出的源头，最重要的输入类是istream、ifstream、istringstream

>### istream
>
>       istream类适合顺序文本模式输入，基类ios的所有功能都包括在istream中
>
>       预定义的istream对象cin用来完成从标准输入设备的输入
>
>       标准输入设备也可以在命令行使用"\<"中重定向，重定向后从文件读取数据
>
>### ifstream
>
>       ifstream类支持磁盘文件输入
>
>       如需仅用于输入的磁盘文件，可以构造ifstream对象，并指定二进制或文本模式
>
>       如果在构造函数中指定文件名，在构造对象时文件自动打开
>
>       否则调用默认构造函数后使用open函数打开文件
>
>       很多格式化选项和成员函数都可以应用于ifstream对象

>### 构造输入流对象
>
>       如果使用文件流从文件中读取数据，必须构造一个输入流对象
>
>       使用默认构造函数建立对象后调用open成员函数打开文件
>
>           ifstream myFile;
>
>           myFile.open("filename");
>
>       在调用构造函数建立文件流对象时指定 文件名和模式
>
>           ifstream myFile("filename"); or
>
>           string filename="file.txt";
>
>           ifstream myFile(filename);

>### 使用提取运算符
>
>       提取运算符">>"对于所用标准Cpp数据类型都预先设计好
>
>       提取运算符用于格式化文本输入，提取数据时以空白符为分割
>
>       如果输入包含空白符的文本，可以使用非格式化输入成员函数getline
>
>       输出流错误处理函数同样可以应用于输入流

>### 输入流操纵符
>
>       定义在ios_base类中和iomanip头文件中的操作符可以应用于输入流
>
>       只要少数几个操作符对输入流对象具有实际影响，最重要的是dec、oct、hex
>
>       hex可接受各种输入流格式，任何0\~9,A\~F,a\~f和X外字符都引起数值变换终止

>### 输入流相关的函数
>
>       输入流的open函数
>
>           如使用文件输入流，须在构造函数中或open函数关联流和特定磁盘文件
>
>           当打开与输入流关联的文件时，通常要指定一个模式标志
>
>               ios_base::in 打开文件用于输入(默认)
>
>               ios_base::binary 以二进制模式打开文件
>
>       输入流的close函数
>
>           如果使用同一流对象打开另一个文件，首先使用close函数关闭当前文件
>
>       get函数
>
>           非格式化get函数的功能与提取运算符相仿，但读入数据时包括空白字符
>
>       getline函数
>
>           允许输入流中读取多个字符，允许指定输入终止字符(默认换行字符)
>
>           成员getline读完从读取内容删除终止字符，将内容存在字符数组不能扩容
>
>           非成员函数getline将内容保存在string类型的对象中，更加方便
>
>           getline可以接受三个参数，输入流，保存string对象和终止字符(可选)
>
>           非成员函数getline声明再string头文件中
>
>       read函数
>
>           从一个文件读字节到一个指定的存储器区域，有长度参数确定要读的字节数
>
>           给出长度参数，遇到文件结束或文本模式中遇到文件结束标记字符时结束
>
>       seekg和tellg函数
>
>           文件输入流保留指向下一将读数据位置的内部指针，可以用seekg设置
>
>           tellg成员函数返回当前文件读指针的位置，这个值是streampos类型

>### 字符串输入流
>
>       提供与字符串输出流相对应的功能
>
>       istringstream两个构造函数，最常用构造函数接受两个参数
>
>       两个参数分别表示要输入的string对象和流的打开模式(默认ios_base::in)
>
>       istringstream有ifstream的大部分功能，只有open和close不具备

## 输入输出流

>       一个iostream对象可以是数据的源或目的
>
>       fstream和stringstream都是从iostream派生，继承了istream和ostream类功能
>
>       fstream类支持磁盘文件输入和输出，一般有两个逻辑子流的单个流
>
>       stringstream类支持面向字符串的输入和输出，可以用于对同一个字符串交替读写

## \*宽字符、宽字符串与宽流

>       宽字符、宽字符串用于解决汉字占据两char字符时出现的问题

>### 宽字符与宽字符串
>
>       一般的宽字符数据占据两字节，类型名称时wchar_t
>
>       一个宽字符文字仍需单引号包含，但在第一个单引号前需加L标识
>
>       wstring表示宽字符串类型，除元素是wchar_t类型外与string完全相同
>
>       宽字符串文字需双引号且第一个双引号前加L标识

>### 宽流
>
>       wstring无法用cout输出，cout基本单位是char类型字符
>
>       一系列输入、输出和输入输出流前加 w可以得到对应流

## \*对象的串行化

>       将对象写入文件的过程叫对象的串行化
>
>       串行化的对象可以通过网络传给其他计算机或储存在数据库中
